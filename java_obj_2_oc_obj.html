




<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Java 转成OC 类对象</title>
    <style>
        .input-area {
            display: flex;
            flex-direction: row;
        }
        #file-area {
            width: 150px;
            height: 50px;
            background: #ccc;
            border: 1px solid #000;
            text-align: center;
            line-height: 50px;
        }
        .loadView0 {
            width: 100%;
            height: calc(100vh - 150px);
            display: flex;
            flex-direction: row;
        }
        .loadView1 {
            width: 45%;
            height: 100%;
        }

        .loadView2 {
            width: 55%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .loadView3 {
            width: 100%;
            height: 40%;
        }

        .loadView4 {
            width: 100%;
            height: 60%;
        }
        .item {
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>
    <h3>Java 转成OC 类对象</h3>
    
    <div class="input-area">
        <div>
            <div id="file-area">文件拖到这里上传</div>
        </div>

        <button onclick="showshowhsohw()">生成 / 转换</button>
        <div>
            <input type="button" onClick="copyContentH()" value="复制 H 代码" />
            <input type="button" onClick="copyContentH2()" value="复制（无注释）H 代码" />
            <input type="button" onClick="copyContentM()" value="复制 M 代码" />
            <br/>
            <input type="button" onClick="downloadActionH()" value="下载 H 代码" />
            <input type="button" onClick="downloadActionH2()" value="下载（无注释）H代码" />
            <input type="button" onClick="downloadActionM()" value="下载 M 代码" />

        </div>
    </div>
    
    
    <div class="loadView0">
        <div class="loadView1">
            <textarea class="item" id="item1"></textarea>
        </div>
        <div class="loadView2">
            <div class="loadView3"><textarea class="item" id="item2"></textarea></div>
            <div class="loadView4"><textarea class="item" id="item3"></textarea></div>
        </div>
        <textarea id="itemHidden" hidden></textarea>
    </div>

    <script>
        var globalTextH = ''
        var globalTextH_noComment = ''
        var globalTextM = ''
        var globalTextM_noComment = ''
        var theFileName = '';
    </script>

    <script>
        let textStr = 
        "public class TabAddrID {" +"\n"+


        "    public static final Number p01 = 123;" +"\n"+
        "    public static final Number p02 = 1.23;" +"\n"+



        "    public static final int p1 = 111;" +"\n"+
        "    /**" +"\n"+
        "    测试多注释" +"\n"+
        "    */" +"\n"+

        "    public static final String p2 = 'ZZZ';" +"\n"+
        '    public static final String p3 = "AAA";' +"\n"+

        "    public static final int p4 = 3333;" +"\n"+
        "    public static final int p5 = 3334; //测试单注释" +"\n"+
        "    public static final int p6 = 3335;" +"\n"+

        "    public static final double p601 = 123.321;" +"\n"+

        "    public static final int p7[]={" +"\n"+
        "        222," +"\n"+
        "    };" +"\n"+


        "    public static final double p701[] = {" +"\n"+
        "        1.1," +"\n"+
        "        1.2," +"\n"+
        "    };" +"\n"+

        "    public static final String p8[]={" + ' "A",' +"\n"+
        "        'B'," +"\n"+
        "        'C'," +"\n"+
        '        "D",' +"\n"+
        "    };" +"\n"+

        "    public static final String p9[]={ 'Q', 'P' };" +"\n"+

        "    public static final int p10[]={" +"\n"+
        "        100, // tested" +"\n"+
        "        101," +"\n"+
        "        102," +"\n"+
        "        103," +"\n"+
        "    };" +"\n"+


        "    public static final Number p11[] = {" +"\n"+
        "        99," +"\n"+
        "        88.6," +"\n"+
        "    };" +"\n"+




        "    public static final int p12[2][5] = {" +"\n"+
        "        {1,2,3,4,5}," +"\n"+
        "        {11,12,13,14,15}," +"\n"+
        "    };" +"\n"+



        "    public static final String p13[2][5] = {" +"\n"+
        "        { 'A', 'B' , 'C' }," +"\n"+
        '        { "a","b" } ,' +"\n"+
        "    };" +"\n"+
        


        "    public static final int p14 = 40;" +"\n"+
        "    public static final int p15 = 80;" +"\n"+


        "    public static final Number p16[] = {" +"\n"+
        "        p14," +"\n"+
        "        p15," +"\n"+
        "    };" +"\n"+


        "    public static final Number p17 = p01;" +"\n"+
        "    public static final Number p18 = 20;" +"\n"+


        "    public static final int p19 = p01;" +"\n"+
        "    public static final int p20 = 20;" +"\n"+


        "}"

        
        document.getElementById('item1').value = textStr;
    </script>

    <script>
        function getClassNameWithString(str) {
            let pos = str.indexOf("class");
            if (pos >= 0) {
                pos += 5;
                let pos2 = str.indexOf("{");
                if (pos2 > 0) {
                    let tempStr = str.slice(pos, pos2);
                    let tempArr = tempStr.split(' ');
                    if (tempArr.length == 3) {
                        return tempArr[1]
                    }
                }
            }
            return 'NoKonw';
        }

        function getItemWithString(str) {
            

            let hasEqualSign = str.indexOf("=") >= 0 ? true : false;
            if (hasEqualSign) {
                //有等于号存在
                // console.log('getItemWithString',str);

                let theObj = {};
                theObj.pIsArrArr = false;

                let objIsString  = false;
                let objIsInt  = false;

                let theObjArray = str.split('=');
                let theObjDefine = theObjArray[0];
                let theObjDefineArray = theObjDefine.split(' ');
                let tempObjDefineArrayKeep = [];
                for (let i = 0; i < theObjDefineArray.length; i++) {
                    let tempItem = theObjDefineArray[i];
                    if ( typeof(tempItem) == 'string' && tempItem.length > 0) {
                        tempObjDefineArrayKeep.push(tempItem)
                    }
                }
                theObjDefineArray = tempObjDefineArrayKeep;
                let objDefineNameIndex = theObjDefineArray.length - 1;
                let objDefineTypeIndex = theObjDefineArray.length - 2;


                let theObjIsArray = theObjDefine.indexOf('[]') >= 0 ? true : false;
                let theObjIsArrayArray = false;
                let theObjArrayArrayCount = 0;

                if (theObjIsArray) {
                    //是数组
                    let tempObjDefineArray = theObjDefine.split('[]');
                    theObjDefineArray = tempObjDefineArray[0].split(' ');
                    let tempObjDefineArrayKeep = [];
                    for (let i = 0; i < theObjDefineArray.length; i++) {
                        let tempItem = theObjDefineArray[i];
                        if ( typeof(tempItem) == 'string' && tempItem.length > 0) {
                            tempObjDefineArrayKeep.push(tempItem)
                        }
                    }
                    theObjDefineArray = tempObjDefineArrayKeep;
                    objDefineNameIndex = theObjDefineArray.length - 1;
                    objDefineTypeIndex = theObjDefineArray.length - 2;
                } else {
                    //不是数组

                    let theObjLeftPos = theObjDefine.indexOf('[');
                    let theObjRightPos = theObjDefine.indexOf(']');
                    if (theObjLeftPos >= 0 && theObjRightPos >= 0 && theObjRightPos > theObjLeftPos) {
                        //判断到是数组，但不是[]，而是[3]这种类型
                        // console.log("判断到是数组，但不是[]，而是[3]这种类型",theObjDefine)

                        let tempObjDefineArray = theObjDefine.split('[');
                        // console.log(tempObjDefineArray)

                        theObjDefineArray = tempObjDefineArray[0].split(' ');
                        let tempObjDefineArrayKeep = [];
                        for (let i = 0; i < theObjDefineArray.length; i++) {
                            let tempItem = theObjDefineArray[i];
                            if ( typeof(tempItem) == 'string' && tempItem.length > 0) {
                                tempObjDefineArrayKeep.push(tempItem)
                            }
                        }
                        theObjDefineArray = tempObjDefineArrayKeep;
                        objDefineNameIndex = theObjDefineArray.length - 1;
                        objDefineTypeIndex = theObjDefineArray.length - 2;

                        // let tempObjDefineArrayKeep2 = [];
                        // for (let i = 1; i < tempObjDefineArray.length; i++) {
                        //     tempObjDefineArrayKeep2.push()
                        // }
                        let arrayCount = tempObjDefineArray.length - 1;
                        if (arrayCount == 2) {
                            let temp123 = tempObjDefineArray[1];
                            let temp123Array = temp123.split(']');
                            let temp123Value = temp123Array[0];
                            temp123Value = temp123Value.replace(/(^\s*)|(\s*$)/g, "");//移除两边的空格
                            // console.log('temp123',temp123)
                            theObjIsArrayArray = true;
                            theObjArrayArrayCount = parseInt(temp123Value);
                        }


                    }
                }


                let objDefineName = '';
                let objDefineType = '';
                if (objDefineNameIndex > 0) {objDefineName = theObjDefineArray[objDefineNameIndex];}
                if (objDefineTypeIndex > 0) {objDefineType = theObjDefineArray[objDefineTypeIndex];}
                theObj.pName = objDefineName;
                theObj.pType = objDefineType;
                theObj.pIsArr = theObjIsArray;

                if (theObjIsArrayArray) {
                    theObj.pIsArrArr = true;
                    theObj.pArrArrCount = theObjArrayArrayCount;
                    theObj.pArrArrIndex = 0; 
                }

                if (objDefineType == 'int') { objIsInt = true; }
                if (objDefineType == 'String') { objIsString = true; }

                let theObjContent = theObjArray[1];
                if (theObjIsArrayArray) {
                    //数据提取超级麻烦。。。。
                    // console.log('数组数组对象的内容',theObjContent);

                    let keepContent = [];

                    for (let i = 0; i < theObjArrayArrayCount; i++) {
                        keepContent.push([]);
                    }

                    let posLeft = theObjContent.indexOf('{');
                    let posRight = theObjContent.indexOf('}');
                    
                    if (posLeft >= 0 && posRight >= 0 && posRight > posLeft) {
                        //这是一个完整的赋值内容。
                        // console.log('这是一个完整的赋值内容');

                        let leftCount = theObjContent.split('{').length - 1;
                        let rightCount = theObjContent.split('}').length - 1;

                        theObj.hasFirstLeft = true;

                        if (leftCount == rightCount) {
                            theObj.hasFirstRight = true;
                        }


                        let tempStr = theObjContent.slice(posLeft + 1, posRight);
                        let tempArr = tempStr.split(',');
                        let tempArrKeep = [];
                        for (let i = 0; i < tempArr.length; i++) {
                            let tempStr2 = tempArr[i];
                            // let tempArr2 = tempStr2.split(' ');
                            tempStr2 = tempStr2.replace(/(^\s*)|(\s*$)/g, "");//移除两边的空格
                            // console.log(tempStr2,'---------','['+tempStr2+']');
                            keepContent.push(tempStr2)
                        }
                        // console.log('tempArr',tempArr)

                    } else if (posLeft >= 0 && posRight == -1) {
                        //只有左花括号，没有右花括号
                        let tempArr = theObjContent.split('{');
                        // console.log('只有左花括号',tempArr);


                        theObj.hasFirstLeft = true;

                        for (let i = 0; i < tempArr.length; i++) {
                            let temp = tempArr[i];
                            temp = temp.replace(/(^\s*)|(\s*$)/g, "");//移除两边的空格
                            if (temp.length > 0) {
                                let tempArr2 = temp.split(',');
                                // console.log('temp--',temp,tempArr2)
                                for (let j = 0; j < tempArr2.length; j++) {
                                    let tempStr2 = tempArr2[j];
                                    tempStr2 = tempStr2.replace(/(^\s*)|(\s*$)/g, "");//移除两边的空格
                                    if (tempStr2.length > 0) {
                                        keepContent.push(tempStr2);
                                    }
                                }
                            }
                        }
                    }

                    theObj.pValue = keepContent;

                } else if (theObjIsArray) {
                    //数据提取有点麻烦。。。。
                    // console.log('数组对象的内容',theObjContent);

                    let keepContent = [];

                    let posLeft = theObjContent.indexOf('{');
                    let posRight = theObjContent.indexOf('}');
                    if (posLeft >= 0 && posRight >= 0 && posRight > posLeft) {
                        //这是一个完整的赋值内容。
                        // console.log('这是一个完整的赋值内容');
                        let tempStr = theObjContent.slice(posLeft + 1, posRight);
                        let tempArr = tempStr.split(',');
                        let tempArrKeep = [];
                        for (let i = 0; i < tempArr.length; i++) {
                            let tempStr2 = tempArr[i];
                            // let tempArr2 = tempStr2.split(' ');
                            tempStr2 = tempStr2.replace(/(^\s*)|(\s*$)/g, "");//移除两边的空格
                            // console.log(tempStr2,'---------','['+tempStr2+']');
                            keepContent.push(tempStr2)
                        }
                        // console.log('tempArr',tempArr)

                    } else if (posLeft >= 0 && posRight == -1) {
                        //只有左花括号，没有右花括号
                        let tempArr = theObjContent.split('{');
                        // console.log('只有左花括号',tempArr);
                        for (let i = 0; i < tempArr.length; i++) {
                            let temp = tempArr[i];
                            if (temp.length > 0) {
                                let tempArr2 = temp.split(',');
                                // console.log('temp--',temp,tempArr2)
                                for (let j = 0; j < tempArr2.length; j++) {
                                    let tempStr2 = tempArr2[j];
                                    tempStr2 = tempStr2.replace(/(^\s*)|(\s*$)/g, "");//移除两边的空格
                                    if (tempStr2.length > 0) {
                                        keepContent.push(tempStr2);
                                    }
                                }
                            }
                        }
                    }

                    theObj.pValue = keepContent;

                } else {
                    //双引号是否存在
                    let stringContentDoubleQuotationMarks = theObjContent.indexOf('"') >= 0 ? true : false;
                    //单引号是否存在
                    let stringContentSingleQuotationMarks = theObjContent.indexOf("'") >= 0 ? true : false;

                    
                    let tempArr = theObjContent.split(';');
                    if (tempArr.length == 2) {
                        let tempStr = tempArr[0];
                        tempStr = tempStr.replace(/(^\s*)|(\s*$)/g, "");//移除两边的空格
                        theObj.pValue = tempStr;
                    } else {
                        console.log('存在其他情况')
                    }
                }

                return theObj;
            }

            // console.log('theObj',theObj);
            
            return null;
        }

        function getNoCommentString(str) {
            let arr = str.split('\n');
            let currnetMultipleComment = false;
            let currentObjectIsArray = false;
            let currentArrayObject = null;
            let theStr = '';

            let keepObjs = [];

            arr.forEach((item, index) => {
                let hasSingleComment = false;
                let hasMultipleCommentHead = false;
                let hasMultipleCommentFoot = false;

                let posSingleComment = item.indexOf("//");
                let posMultipleCommentHead = item.indexOf("/*");
                let posMultipleCommentFoot = item.indexOf("*/");

                
                // console.log('posSingleComment',posSingleComment);
                // console.log('posMultipleCommentHead',posMultipleCommentHead);
                // console.log('posMultipleCommentFoot',posMultipleCommentFoot);

                if (posSingleComment >= 0) {hasSingleComment = true;}
                if (posMultipleCommentHead >= 0) {hasMultipleCommentHead = true;}
                if (posMultipleCommentFoot >= 0) {hasMultipleCommentFoot = true;}

                if (!hasMultipleCommentHead && !hasMultipleCommentFoot && !hasSingleComment) {
                    // console.log('不存在注释');
                    if (!currnetMultipleComment) {
                        theStr += item + '\n';

                        let theObj = getItemWithString(item);
                        if (theObj != null) {
                            keepObjs.push(theObj);
                            // console.log("0---->theObj",theObj)

                            if (theObj.pIsArr) {
                                // console.log('当前对象是数组对象',theObj);
                                currentArrayObject = theObj;
                            } else if (theObj.pIsArrArr) {
                                // console.log('当前对象是数组数组对象',theObj);
                                currentArrayObject = theObj;
                            }
                        } else {
                            // console.log('这个解析不了对象',item);
                            item = item.replace(/(^\s*)|(\s*$)/g, "");//移除两边的空格
                            if (item.length > 0) {

                                // console.log(currentArrayObject)
                                if (currentArrayObject != null && currentArrayObject.pIsArrArr) {

                                    // console.log('______ssasd-ada----a-sda')

                                    let posLeft = item.indexOf('{');
                                    let posRight = item.indexOf('}');

                                    if (currentArrayObject.hasFirstLeft) {
                                        //已经存在第一个左花括号
                                        // console.log('已经存在第一个左花括号',posLeft,posRight)
                                        if (posLeft >= 0 && posRight >= 0 && posRight > posLeft) {
                                            //这行也存在一个完整的花括号，莫非是数组？
                                            // console.log('->'+item+'<-')

                                            if (item.split("")[item.length - 1] == ',') {
                                                // console.log('最后一个字符串是逗号');
                                                item = item.substring(0, item.length - 1);
                                            }


                                            let leftCount = item.split('{').length - 1;
                                            let rightCount = item.split('}').length - 1;
                                            if (leftCount == rightCount) {
                                                let tempItemArray = item.split('}');
                                                let tempItem = tempItemArray[0];
                                                tempItemArray = tempItem.split('{');
                                                tempItem = tempItemArray[1];

                                                // console.log('tempItem',tempItem)

                                                tempItemArray = tempItem.split(',');
                                                for (let i = 0; i < tempItemArray.length; i++) {
                                                    let tempTemp = tempItemArray[i];
                                                    tempTemp = tempTemp.replace(/(^\s*)|(\s*$)/g, "");//移除两边的空格
                                                    currentArrayObject.pValue[currentArrayObject.pArrArrIndex].push(tempTemp)
                                                }

                                                currentArrayObject.pArrArrIndex++;
                                            }


                                        }
                                    }




                                } else {

                                    let posRight = item.indexOf("}");
                                    // console.log('posRight',posRight)
                                    if (posRight == -1) {
                                        let tempArr = item.split(',');
                                        if (tempArr.length > 0) {
                                            for (let i = 0; i < tempArr.length; i++) {
                                                let tempStr = tempArr[i];
                                                if (tempStr.length > 0) {
                                                    tempStr = tempStr.replace(/(^\s*)|(\s*$)/g, "");//移除两边的空格
                                                    if (tempStr.length > 0) {
                                                        if (currentArrayObject != null && currentArrayObject.pValue != null) {
                                                            currentArrayObject.pValue.push(tempStr)
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    } else if (posRight == 0) {
                                        
                                    }

                                }

                                

                                
                            }
                        }
                        
                    }
                    
                } else if (!hasMultipleCommentHead && !hasMultipleCommentFoot && hasSingleComment) {
                    if (!currnetMultipleComment) {
                        // theStr += item + '\n';

                        // console.log('----------------------------------index',index);
                        // console.log('只存在 单行注释');
                        let tempArr = item.split('//');
                        let tempItem = tempArr[0];
                        // console.log(tempArr,tempItem)
                        theStr += tempItem + '\n';


                        let theObj = getItemWithString(tempItem);
                        if (theObj != null) {
                            keepObjs.push(theObj);
                            // console.log("1---->theObj",theObj)
                            if (theObj.pIsArr) {
                                // console.log('当前对象是数组对象',theObj);
                            }
                        } else {
                            tempItem = tempItem.replace(/(^\s*)|(\s*$)/g, "");//移除两边的空格
                            if (tempItem.length > 0) {

                                let posRight = tempItem.indexOf("}");
                                // console.log('posRight',posRight)
                                if (posRight == -1) {
                                    let tempArr = tempItem.split(',');
                                    if (tempArr.length > 0) {
                                        for (let i = 0; i < tempArr.length; i++) {
                                            let tempStr = tempArr[i];
                                            if (tempStr.length > 0) {
                                                tempStr = tempStr.replace(/(^\s*)|(\s*$)/g, "");//移除两边的空格
                                                if (tempStr.length > 0) {
                                                    if (currentArrayObject != null && currentArrayObject.pValue != null) {
                                                        currentArrayObject.pValue.push(tempStr)
                                                    }
                                                }
                                            }
                                        }
                                    }
                                } else if (posRight == 0) {
                                    
                                }
                            }

                            // currentArrayObject.pValue.push(tempItem)
                            // console.log('=====-=-======-==-----=====', theObj,currentArrayObject)
                            
                        }
                    }

                } else if (hasMultipleCommentHead && !hasMultipleCommentFoot && !hasSingleComment) {
                    // console.log('----------------------------------index',index);
                    // console.log('只存在 多行注释头');

                    let tempArr = item.split('/*');
                    theStr += tempArr[0] + '\n';

                    currnetMultipleComment = true;

                } else if (!hasMultipleCommentHead && hasMultipleCommentFoot && !hasSingleComment) {
                    // console.log('----------------------------------index',index);
                    // console.log('只存在 多行注释尾');

                    let tempArr = item.split('*/');
                    theStr += tempArr[1] + '\n';

                    //遇到多行注释尾，则清除标记。
                    currnetMultipleComment = false;

                } else if (hasMultipleCommentHead && hasMultipleCommentFoot && !hasSingleComment) {
                    // console.log('----------------------------------index',index);
                    // console.log('存在 多行注释头 和 多行注释尾');
                } else {
                    console.log('----------------------------------index',index);
                    console.log('其他情况的注释');
                }

            });


            let className = getClassNameWithString(theStr)

            console.log('处理后的内容',theStr);
            // console.log('className',className);
            // console.log('keepObjs',keepObjs);


            return {className:className, objs:keepObjs}
        }




        function handleInputString(newStr) {
            let keepArr = []
            let keepComment = {}
            let hasMultiLineCommentFlag = false

            let hasSingleLineCommentFlag = false

            let hasHead = false;


            let theObj = getNoCommentString(newStr)

            console.log('theObj',theObj);

            let theClassName = theObj.className;
            let theObjs = theObj.objs;

            let resultFilename = theClassName + 'Object';

            /*********************************************************/
            /***********     H 无注释   start      ********/
            /*********************************************************/
            let resultStrH_noComment = '';
            resultStrH_noComment += "#import <Foundation/Foundation.h>" + '\n';
            resultStrH_noComment += '\n';
            resultStrH_noComment += "#define " + theClassName + " ([" + resultFilename + " shared])" + '\n';
            resultStrH_noComment += '\n';
            resultStrH_noComment += "@interface " + resultFilename + " : NSObject" + '\n';
            resultStrH_noComment += '\n';

            for (let i = 0; i < theObjs.length; i++) {
                let obj = theObjs[i];
                if (obj) {
                    // console.log(i,'------->>>>>>>>>',obj)
                    // resultStrH_noComment += '@property(nonatomic,assign) int ' + obj.pName + ';' + '\n';
                    if (obj.pIsArrArr) {
                        resultStrH_noComment += '//共有 ' + obj.pValue.length + ' 个数组'  + '\n';
                        resultStrH_noComment += '@property(nonatomic,strong) NSArray<NSArray<NSNumber *> *> *' + obj.pName + ';' + '\n';
                        resultStrH_noComment += '\n';
                    } else if (obj.pIsArr) {
                        resultStrH_noComment += '//共有 ' + obj.pValue.length + ' 个内容' + '\n';

                        if (obj.pType == 'int') {
                            resultStrH_noComment += '@property(nonatomic,strong) NSArray<NSNumber *> *' + obj.pName + ';' + '\n';
                            resultStrH_noComment += '\n';
                        } else if (obj.pType == 'String') {
                            resultStrH_noComment += '@property(nonatomic,strong) NSArray<NSString *> *' + obj.pName + ';' + '\n';
                            resultStrH_noComment += '\n';
                        } else if (obj.pType == 'double') {
                            resultStrH_noComment += '@property(nonatomic,strong) NSArray<NSNumber *> *' + obj.pName + ';' + '\n';
                            resultStrH_noComment += '\n';
                        } else if (obj.pType == 'Number') {
                            resultStrH_noComment += '@property(nonatomic,strong) NSArray<NSNumber *> *' + obj.pName + ';' + '\n';
                            resultStrH_noComment += '\n';
                        }
                    } else {
                        if (obj.pType == 'int') {
                            resultStrH_noComment += '@property(nonatomic,assign) int ' + obj.pName + ';' + '\n';
                            resultStrH_noComment += '\n';
                        } else if (obj.pType == 'String') {
                            resultStrH_noComment += '@property(nonatomic,copy) NSString *' + obj.pName + ';' + '\n';
                            resultStrH_noComment += '\n';
                        } else if (obj.pType == 'double') {
                            resultStrH_noComment += '@property(nonatomic,assign) double ' + obj.pName + ';' + '\n';
                            resultStrH_noComment += '\n';
                        } else if (obj.pType == 'Number') {
                            resultStrH_noComment += '@property(nonatomic,strong) NSNumber *' + obj.pName + ';' + '\n';
                            resultStrH_noComment += '\n';
                        }
                    }
                }
            }

            resultStrH_noComment += '\n';
            resultStrH_noComment += '+ (instancetype) shared;\n';
            resultStrH_noComment += '\n';
            resultStrH_noComment += '@end' + '\n';
            resultStrH_noComment += '\n';
            /*********************************************************/
            /***********     H 无注释   end      ********/
            /*********************************************************/


            /*********************************************************/
            /***********     H 有注释   start      ********/
            /*********************************************************/
            let resultStrH = '';
            resultStrH += "#import <Foundation/Foundation.h>" + '\n';
            resultStrH += '\n';
            resultStrH += "#define " + theClassName + " ([" + resultFilename + " shared])" + '\n';
            resultStrH += '\n';
            resultStrH += "@interface " + resultFilename + " : NSObject" + '\n';
            resultStrH += '\n';

            for (let i = 0; i < theObjs.length; i++) {
                let obj = theObjs[i];
                // console.log(obj)
                if (obj) {
                    // console.log('.....')
                    if (obj.pIsArrArr) {
                        resultStrH += '//共有 ' + obj.pValue.length + ' 个数组'  + '\n';
                        resultStrH += '@property(nonatomic,strong) NSArray<NSArray<NSNumber *> *> *' + obj.pName + ';' + '\n';
                        resultStrH += '\n';
                    } else if (obj.pIsArr) {
                        resultStrH += '//共有 ' + obj.pValue.length + ' 个内容'  + '\n';

                        if (obj.pType == 'int') {
                            resultStrH += '@property(nonatomic,strong) NSArray<NSNumber *> *' + obj.pName + ';' + '\n';
                            resultStrH += '\n';
                        } else if (obj.pType == 'String') {
                            resultStrH += '@property(nonatomic,strong) NSArray<NSString *> *' + obj.pName + ';' + '\n';
                            resultStrH += '\n';
                        } else if (obj.pType == 'double') {
                            resultStrH += '@property(nonatomic,strong) NSArray<NSNumber *> *' + obj.pName + ';' + '\n';
                            resultStrH += '\n';
                        } else if (obj.pType == 'Number') {
                            resultStrH += '@property(nonatomic,strong) NSArray<NSNumber *> *' + obj.pName + ';' + '\n';
                            resultStrH += '\n';
                        }
                    } else {
                        if (obj.pType == 'int') {
                            resultStrH += '@property(nonatomic,assign) int ' + obj.pName + ';' + '\n';
                            resultStrH += '\n';
                        } else if (obj.pType == 'String') {
                            resultStrH += '@property(nonatomic,copy) NSString *' + obj.pName + ';' + '\n';
                            resultStrH += '\n';
                        } else if (obj.pType == 'double') {
                            resultStrH += '@property(nonatomic,assign) double ' + obj.pName + ';' + '\n';
                            resultStrH += '\n';
                        } else if (obj.pType == 'Number') {
                            resultStrH += '@property(nonatomic,strong) NSNumber *' + obj.pName + ';' + '\n';
                            resultStrH += '\n';
                        }
                    }
                    
                    

                //     let comment = keepComment[obj];
                //     // console.log(key, comment)
                    
                //     // if (comment != undefined && comment.length > 0) {
                //     //     let tempArr = comment.split("//");
                //     //     if (tempArr.length > 1) {
                //     //         tempArr = tempArr.shift();
                //     //     }
                //     //     console.log('tempArr : ',tempArr)
                //     //     comment = tempArr.join('//')

                //     //     resultStrH += '/**' + '\n';
                //     //     resultStrH += comment + '\n';
                //     //     resultStrH += '*/' + '\n';
                //     // }
                //     if (comment != undefined && comment.length > 0) {
                //         resultStrH += '@property(nonatomic,assign) int ' + key + ';' + '    ' + comment + '\n';
                //     } else {

                //         resultStrH += '@property(nonatomic,assign) int ' + key + ';' + '\n';
                //     }
                }
            }

            resultStrH += '\n';
            resultStrH += '+ (instancetype) shared;\n';
            resultStrH += '\n';
            resultStrH += '@end' + '\n';
            resultStrH += '\n';
            /*********************************************************/
            /***********     H 有注释   end      ********/
            /*********************************************************/



            // let maxLength = 0;
            // for (let i = 0; i < keys.length; i++) {
            //     let key = keys[i];
            //     if (key.length > maxLength) {
            //         maxLength = key.length;
            //     }
            // }

            /*********************************************************/
            /***********     M 无注释   start      ********/
            /*********************************************************/
            let resultClassInstanceName = resultFilename + 'ShareInstance';

            let resultStrM_noComment = '';
            resultStrM_noComment += '#import "' + resultFilename + '.h"' + '\n';
            resultStrM_noComment += '\n';
            resultStrM_noComment += 'static id ' + resultClassInstanceName + ' = nil;' + '\n';
            resultStrM_noComment += '\n';
            resultStrM_noComment += '@implementation ' + resultFilename + '\n';
            resultStrM_noComment += '\n';
            resultStrM_noComment += '+ (instancetype) shared {' + '\n';
            resultStrM_noComment += '    static dispatch_once_t onceToken;' + '\n';
            resultStrM_noComment += '    dispatch_once(&onceToken, ^{' + '\n';
            resultStrM_noComment += '        ' + resultClassInstanceName + ' = [[self class] new];' + '\n';
            resultStrM_noComment += '    });' + '\n';
            resultStrM_noComment += '    return ' + resultClassInstanceName + ';' + '\n';
            resultStrM_noComment += '}' + '\n';
            resultStrM_noComment += '\n';
            resultStrM_noComment += '- (instancetype) init {\n';
            resultStrM_noComment += '    if (self = [super init]) {\n';
            resultStrM_noComment += '        [self setupCoreInit];' + '\n';
            resultStrM_noComment += '    }\n';
            resultStrM_noComment += '    return self;\n';
            resultStrM_noComment += '}\n';
            resultStrM_noComment += '\n';
            resultStrM_noComment += '- (void) setupCoreInit {\n';
            for (let i = 0; i < theObjs.length; i++) {
                let obj = theObjs[i];
                if (obj) {
                    if (obj.pIsArrArr) {
                        let tempKeepStr = '';
                        tempKeepStr += '@[' + '\n';

                        if (obj.pValue.length > 0) {
                            for (let i = 0; i < obj.pValue.length; i++) {
                                tempKeepStr += '        @[' + '\n';

                                let tempArr = obj.pValue[i];
                                for (let j = 0; j < tempArr.length; j++) {
                                    let tempArrItem = tempArr[j];

                                    let isExsit = false;

                                    for (let k = 0; k < theObjs.length; k++) {
                                        if (tempArrItem == theObjs[k].pName) {
                                            isExsit = true;
                                            break
                                        }
                                    }


                                    if (isExsit) {
                                        tempKeepStr += '            ' +'_'+ tempArrItem + '' + ',' + '\n';
                                    } else {
                                        if (obj.pType == 'int' || obj.pType == 'double' || obj.pType == 'Number') {
                                            tempKeepStr += '            ' +'@('+ tempArrItem + ')' + ',' + '\n';
                                        } else if (obj.pType == 'String') {
                                            tempKeepStr += '            ' +'@'+ tempArrItem + '' + ',' + '\n';
                                        }
                                    }


                                    
                                }

                                tempKeepStr += '        ],' + '\n';
                            }
                        }

                        tempKeepStr += '    ]';
                        resultStrM_noComment += '    _' + obj.pName + ' = ' + tempKeepStr + ';\n';
                    } else if (obj.pIsArr) {
                        if (obj.pType == 'String') {
                            let tempKeepStr = '';
                            tempKeepStr += '@[' + '\n';
                            for (let j = 0; j < obj.pValue.length; j++) {
                                let tempItem = obj.pValue[j];
                                tempItem = tempItem.replace(/'/g, '"');//将单引号全部转成双引号

                                let isExsit = false;

                                for (let k = 0; k < theObjs.length; k++) {
                                    if (tempItem == theObjs[k].pName) {
                                        isExsit = true;
                                        break
                                    }
                                }

                                if (isExsit) {
                                    tempKeepStr += '        ' + '_' + tempItem + ',' + '\n';
                                } else {
                                    tempKeepStr += '        ' + '@' + tempItem + ',' + '\n';
                                }
                                
                            }
                            tempKeepStr += '    ]';
                            resultStrM_noComment += '    _' + obj.pName + ' = ' + tempKeepStr + ';\n';

                        } else if (obj.pType == 'int') {
                            let tempKeepStr = '';
                            tempKeepStr += '@[' + '\n';
                            for (let j = 0; j < obj.pValue.length; j++) {
                                let tempItem = obj.pValue[j];

                                let isExsit = false;

                                for (let k = 0; k < theObjs.length; k++) {
                                    if (tempItem == theObjs[k].pName) {
                                        isExsit = true;
                                        break
                                    }
                                }

                                if (isExsit) {
                                    tempKeepStr += '        ' + '_'+ tempItem +',' + '\n';
                                } else {
                                    tempKeepStr += '        ' + '@('+ tempItem +'),' + '\n';
                                }
                            }
                            tempKeepStr += '    ]';
                            resultStrM_noComment += '    _' + obj.pName + ' = ' + tempKeepStr + ';\n';
                        } else if (obj.pType == 'double') {
                            let tempKeepStr = '';
                            tempKeepStr += '@[' + '\n';
                            for (let j = 0; j < obj.pValue.length; j++) {
                                let tempItem = obj.pValue[j];

                                let isExsit = false;

                                for (let k = 0; k < theObjs.length; k++) {
                                    if (tempItem == theObjs[k].pName) {
                                        isExsit = true;
                                        break
                                    }
                                }

                                if (isExsit) {
                                    tempKeepStr += '        ' + '_'+ tempItem +',' + '\n';
                                } else {
                                    tempKeepStr += '        ' + '@('+ tempItem +'),' + '\n';
                                }
                            }
                            tempKeepStr += '    ]';
                            resultStrM_noComment += '    _' + obj.pName + ' = ' + tempKeepStr + ';\n';
                        } else if (obj.pType == 'Number') {
                            let tempKeepStr = '';
                            tempKeepStr += '@[' + '\n';
                            for (let j = 0; j < obj.pValue.length; j++) {
                                let tempItem = obj.pValue[j];

                                let isExsit = false;

                                for (let k = 0; k < theObjs.length; k++) {
                                    if (tempItem == theObjs[k].pName) {
                                        isExsit = true;
                                        break
                                    }
                                }

                                if (isExsit) {
                                    tempKeepStr += '        ' + '_'+ tempItem +',' + '\n';
                                } else {
                                    tempKeepStr += '        ' + '@('+ tempItem +'),' + '\n';
                                }
                            }
                            tempKeepStr += '    ]';
                            resultStrM_noComment += '    _' + obj.pName + ' = ' + tempKeepStr + ';\n';
                        }
                    } else {
                        if (obj.pType == 'String') {
                            let tempValue = obj.pValue;
                            // console.log('tempValue xxxx',tempValue)

                            tempValue = tempValue.replace(/'/g, '"');//将单引号全部转成双引号

                            // if (tempValue.slice(0, 1) == '"') {
                            //     console.log("第一个是单引号")
                            //     console.log('xxxxx',tempValue);
                            //     let tempValueArr = tempValue.split("'");
                            //     let tempValueStringkeep = '';
                            //     tempValueStringkeep += '"';
                            //     for (let i = 1; i < tempValueArr.length - 1; i++) {
                            //         tempValueStringkeep += tempValueArr[i];
                            //     }
                            //     tempValueStringkeep += '"';
                            //     tempValue = tempValueStringkeep;
                            // } else if (tempValue.slice(0, 1) == '"') {
                            //     console.log("第一个是双引号")
                            // }
                            // console.log('xxxssss',tempArr)
                            // let stringContentSingleQuotationMarks = tempValue.indexOf("'") >= 0 ? true : false;
                            // if (stringContentSingleQuotationMarks == 0) {
                                
                            // }


                            let isExsit = false;

                            for (let k = 0; k < theObjs.length; k++) {
                                if (tempValue == theObjs[k].pName) {
                                    isExsit = true;
                                    break
                                }
                            }

                            if (isExsit) {
                                
                                resultStrM_noComment += '    _' + obj.pName + ' = ' + tempValue + ';\n';
                            } else {

                                tempValue = '@' + tempValue;
                                resultStrM_noComment += '    _' + obj.pName + ' = ' + tempValue + ';\n';
                            }
                        } else if (obj.pType == 'int') {
                            let isExsit = false;

                            for (let k = 0; k < theObjs.length; k++) {
                                if (obj.pValue == theObjs[k].pName) {
                                    isExsit = true;
                                    break
                                }
                            }

                            if (isExsit) {
                                resultStrM_noComment += '    _' + obj.pName + ' = _' + obj.pValue + ';\n';
                            } else {
                                resultStrM_noComment += '    _' + obj.pName + ' = ' + obj.pValue + ';\n';
                            }
                        } else if (obj.pType == 'double') {


                            let isExsit = false;

                            for (let k = 0; k < theObjs.length; k++) {
                                if (obj.pValue == theObjs[k].pName) {
                                    isExsit = true;
                                    break
                                }
                            }

                            if (isExsit) {
                                resultStrM_noComment += '    _' + obj.pName + ' = _' + obj.pValue + ';\n';
                            } else {
                                resultStrM_noComment += '    _' + obj.pName + ' = ' + obj.pValue + ';\n';
                            }
                        } else if (obj.pType == 'Number') {

                            let isExsit = false;
                            let isNumber = false;

                            for (let k = 0; k < theObjs.length; k++) {
                                if (obj.pValue == theObjs[k].pName) {
                                    isExsit = true;
                                    if (obj.pType == 'Number') {
                                        isNumber = true;
                                    }
                                    break
                                }
                            }

                            if (isExsit) {
                                if (isNumber) {
                                    resultStrM_noComment += '    _' + obj.pName + ' = ' + '_' + obj.pValue + '' +';\n';
                                } else {
                                    resultStrM_noComment += '    _' + obj.pName + ' = ' + '@(' + obj.pValue + ')' +';\n';
                                }
                                
                            } else {
                                resultStrM_noComment += '    _' + obj.pName + ' = ' + '@(' + obj.pValue + ')' +';\n';
                            }
                        }
                        
                    }
                }
            }
            resultStrM_noComment += '}\n';
            resultStrM_noComment += '\n';

            resultStrM_noComment += '\n';
            resultStrM_noComment += '@end' + '\n';
            resultStrM_noComment += '\n';
            /*********************************************************/
            /***********     M 无注释   end      ********/
            /*********************************************************/



            document.getElementById('item2').value = resultStrH;
            document.getElementById('item3').value = resultStrM_noComment;



            globalTextH = resultStrH;
            globalTextH_noComment = resultStrH_noComment;
            globalTextM = resultStrM_noComment;
            globalTextM_noComment = resultStrM_noComment;
        }
        function handleFileReader(reader) {
            console.log('file reader',reader);
            reader.onload = function fileReadCompleted() {
                

                let textStr = reader.result;

                document.getElementById('item1').value = textStr;

                handleInputString(textStr);
            }
        }
        function showshowhsohw() {
            handleInputString(document.getElementById('item1').value);
        }
    </script>

    <script>
        window.onload = function() {
            var fileArea = document.getElementById("file-area")
            fileArea.addEventListener("dragenter", function() {
                fileArea.innerHTML = "请松手"
            }, false)
            fileArea.addEventListener("dragleave", function() {
                fileArea.innerHTML = "文件拖到这里上传"
            }, false)
            fileArea.addEventListener("dragover", function(ev) {
                ev.preventDefault()
            }, false)
            fileArea.addEventListener("drop", function(ev) {
                fileArea.innerHTML = "文件处理。。。"
                ev.preventDefault()
                let fileReader = new FileReader()
                let file = ev.dataTransfer.files[0]
                console.log(file);
                fileReader.onload = function() {
                    console.log("文件成功", this.result)
                }
                fileReader.onerror = function() {
                    console.log("文件读取失败")
                }

                // theFileName = file.name;
                // console.log('theFileName:',theFileName)
                handleFileReader(fileReader)
                fileReader.readAsText(file)
            }, false)
        }
    </script>

    <script>
    </script>

    <script>
        function copyContentH() {
            navigator.clipboard.writeText(globalTextH);
        }

        function copyContentH2() {
            navigator.clipboard.writeText(globalTextH_noComment);
        }
        function copyContentM() {
            navigator.clipboard.writeText(globalTextM);
        }

        function copyContentM2() {
            navigator.clipboard.writeText(globalTextM_noComment);
        }
    </script>

    <script>
        function downloadActionH() {
            if (globalTextH.length > 0) {
                var timestamp = Date.parse(new Date())
                exportRaw(timestamp + 'H.h', globalTextH)
            }
        }
        function downloadActionH2() {
            if (globalTextH_noComment.length > 0) {
                var timestamp = Date.parse(new Date())
                exportRaw(timestamp + 'H_noComment.h', globalTextH_noComment)
            }
        }
        function downloadActionM() {
            if (globalTextM.length > 0) {
                var timestamp = Date.parse(new Date())
                exportRaw(timestamp + 'M.m', globalTextM)
            }
        }
        function downloadActionM2() {
            if (globalTextM_noComment.length > 0) {
                var timestamp = Date.parse(new Date())
                exportRaw(timestamp + 'M_noComment.m', globalTextM_noComment)
            }
        }

        function fakeClick(obj) {
            var ev = document.createEvent("MouseEvents");
            ev.initMouseEvent("click", true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
            obj.dispatchEvent(ev);
        }

        function exportRaw(name, data) {
            var urlObject = window.URL || window.webkitURL || window;
            var export_blob = new Blob([data]);
            var save_link = document.createElementNS("http://www.w3.org/1999/xhtml", "a")
            save_link.href = urlObject.createObjectURL(export_blob);
            save_link.download = name;
            fakeClick(save_link);
        }
    </script>

    <script>
        // document.getElementById('fileInput').addEventListener('change', function selectedFileChanged(){
        //     // console.log(this.files)

        //     if (this.files.length === 0) {
        //         console.log('请选择文件！')
        //         return
        //     }


        //     const reader = new FileReader()
        //     handleFileReader(reader)
        //     reader.readAsText(this.files[0])
        // })
    </script>
</body>
</html>
